---
title: Sharing your graph
---

import {
  ExpansionPanel,
} from 'gatsby-theme-apollo-docs/src/components/expansion-panel';
import { MultiCodeBlock } from 'gatsby-theme-apollo-docs';
import {EmbeddableExplorer} from 'gatsby-theme-apollo-docs';

Apollo Studio provides features that help you share your graph with both teammates and external consumers.

## The README page

When a user opens one of your graph's variants in Apollo Studio, its **README page** is shown:

Like the typical homepage for a Git repository, this page displays a Markdown-based README that you can edit with any content you like.

> **Note:** Only organization members with the [`Org Admin`, `Graph Admin`, or `Contributor` role](./org/members/) can edit a variant's README. If a variant is [protected](./org/graphs/#protected-variants-enterprise-only), `Contributor`s _cannot_ edit its README.

**Each variant has its own README.** If you edit one variant's README, those edits are _not_ applied to your graph's other variants. Among other uses, this enables you to provide different information to external consumers in a [public variant](#making-a-graph-public).

### README shortcodes

The README supports a collection of variables that you can include in its text. These variables are rendered with the correct value for the current variant.



## Public graphs

You can make individual [variants](./org/graphs/#managing-variants) of your graph public. If you do, **anyone with that variant's public link** can view the following pages for that variant in Studio:

* Home
* Schema
* Explorer

This enables consumers of your graph to learn about your graph's schema and any special usage information (such as authentication details) that you've documented in [the variant's README](#the-readme-page). They can also run properly authenticated operations against your graph with the Explorer.

People outside your organization can't view any _other_ pages for a public variant (Fields, Operations, etc.), and they can never view _any_ pages for private variants. New variants always start as private.

### Making a variant public

> **Note:** Only organization members with the [`Org Admin` or `Graph Admin` role](./org/members/) can toggle a variant's visibility.

1. Go to your graph's Settings page and open the Access tab.
2. Under the Variants section, toggle the switch for the variant you want to make public.
3. Confirm your selection.

You can toggle the switch back to make the variant private again.

## Embedding the Explorer

If you have a [public variant](#public-graphs) of your graph, you can embed the [Apollo Studio Explorer](./explorer/) in a webpage that you can then provide to your graph's consumers. This enables those consumers to test out operations from your own website.

For example, here's an embedded Explorer for an Apollo example graph:

<EmbeddableExplorer
  graphRef="Apollo-Fullstack-Demo-o3tsz8@current"
  graphEndpoint="https://apollo-fullstack-tutorial.herokuapp.com/"
  graphSubscriptionEndpoint="wss://apollo-fullstack-tutorial.herokuapp.com/graphql"
  styles={{width: '100%', height:'450px', border: '0px', borderRadius: '4px'}}
/>

> This embedded Explorer collapses its left column by default because the full three-column layout is a little cramped on this page. You can [customize the embedded Explorer's appearance](#options) to suit the page it's on.

### How it works

**The embedded Explorer does not send network requests directly to your GraphQL server!**

Instead, the Explorer's `iframe` uses the `window.postMessage` method to tell your webpage when the user wants to execute a GraphQL operation. _Your webpage_ is then responsible for sending the operation to your GraphQL server (for example, via `fetch`) and then providing the operation result back to the `iframe` via another `postMessage` call.

Because of this, embedding the Explorer requires additional setup beyond adding an `iframe` to your page.

### Examples

* [This repo](https://github.com/apollographql/embeddable-explorer-demo-react) demonstrates a React app that embeds the Explorer.

    * See in particular [`setupEmbedRelay.ts`](https://github.com/apollographql/embeddable-explorer-demo-react/blob/main/src/setupEmbedRelay.ts), which contains logic for communicating between the `iframe`, your own page, and your GraphQL server.

    * This example is also available on CodeSandbox:

    <a href="https://codesandbox.io/s/github/apollographql/embeddable-explorer-demo-react/tree/main/?fontsize=14&hidenavigation=1&theme=dark">
      <img alt="Edit embedded-explorer-demo" src="https://codesandbox.io/static/img/play-codesandbox.svg" />
    </a>



* The Explorer embedded [above](#embedding-the-explorer) uses [this component](https://github.com/apollographql/gatsby-theme-apollo/blob/main/packages/gatsby-theme-apollo-docs/src/components/embeddable-explorer.js) from Apollo's Gatsby documentation theme.

### Setup

> Before you proceed, make sure you have a [public variant](#public-graphs) of your graph in Apollo Studio.

This section walks you through the code to set up an embedded Explorer. It borrows code from [this `setupEmbedRelay.ts` example](https://github.com/apollographql/embeddable-explorer-demo-react/blob/main/src/setupEmbedRelay.ts) and removes some optional portions for clarity.

#### 1. Define Explorer constants

Your webpage and the embedded Explorer use the `postMessage` API to send messages to each other. Those messages each have a name that indicates the _type_ of message being posted.

Let's define constants for each of those message types, along with a constant for our `iframe`'s `src` URL:

<MultiCodeBlock>

```ts:title=setupEmbedRelay.ts
// URL for any embedded Explorer iframe
export const EMBEDDABLE_EXPLORER_URL =
  "https://explorer.embed.apollographql.com";

// Message types for queries and mutations
const EXPLORER_QUERY_MUTATION_REQUEST = "ExplorerRequest";
const EXPLORER_QUERY_MUTATION_RESPONSE = "ExplorerResponse";

// Message types for subscriptions (not covered in this setup)
const EXPLORER_SUBSCRIPTION_REQUEST = "ExplorerSubscriptionRequest";
const EXPLORER_SUBSCRIPTION_RESPONSE = "ExplorerSubscriptionResponse";
const SUBSCRIPTION_TERMINATION = "ExplorerSubscriptionTermination";
```

</MultiCodeBlock>

#### 2. Set up communication

Next, let's define a function that sets up communication between a webpage and the embedded Explorer's `iframe`. This function defines a callback that will execute whenever `window.postMessage` is called by the `iframe`.

<MultiCodeBlock>

```ts:title=setupEmbedRelay.ts
export function setUpEmbedRelay() {

  // Callback definition
  const onPostMessageReceived = (
    event: MessageEvent<{
      name?: string;
      operation?: string;
      operationName?: string;
      variables?: string;
      headers?: Record<string, string>;
    }>
  ) => {

    // Obtain the iframe element by any applicable logic for your page.
    // This obtains an element with ID `embedded-explorer`.
    const embeddedExplorerIFrame =
      (document.getElementById("embedded-explorer") as HTMLIFrameElement) ??
      undefined;

    // Check to see if the posted message indicates that the user is
    // executing a query or mutation in the Explorer
    const isQueryOrMutation =
      "name" in event.data &&
      event.data.name?.startsWith(`${EXPLORER_QUERY_MUTATION_REQUEST}:`);

    // If the user is executing a query or mutation...
    if (
      isQueryOrMutation &&
      event.data.name &&
      event.data.operation
    ) {

      // Extract the operation's unique ID from the message's name
      // (the ID is after the colon)
      const operationId = event.data.name.split(":")[1];

      // Extract the operation's other details from the event.data object
      const { operation, operationName, variables, headers } = event.data;

      // Execute the operation, providing all required details
      // (we'll define executeOperation next)
      executeOperation({
        operation: event.data.operation,
        operationName,
        variables,
        headers,
        embeddedExplorerIFrame,
        operationId,
      });
    }
  };

  // Execute our callback whenever window.postMessage is called
  window.addEventListener("message", onPostMessageReceived);
}
```

</MultiCodeBlock>

Now we can import and call `setupEmbedRelay` on any page where we'll embed the Explorer. However, we still need to define the `executeOperation` function that's called by our callback.

#### 3. Define operation execution logic

Our webpages can use the `fetch` API to send operations to our GraphQL server. To do this, we need the URL of our server's GraphQL endpoint. Substitute it in the `executeOperation` function below, where indicated.

<MultiCodeBlock>

```ts:title=setupEmbedRelay.ts
// Helper function that adds content-type: application/json
// to each request's headers if not present
function getHeadersWithContentType(
  headers: Record<string, string> | undefined
) {
  const headersWithContentType = headers ?? {};
  if (
    Object.keys(headersWithContentType).every(
      (key) => key.toLowerCase() !== "content-type"
    )
  ) {
    headersWithContentType["content-type"] = "application/json";
  }
  return headersWithContentType;
}

// Function for executing operations
async function executeOperation({
  operation,
  operationName,
  variables,
  headers,
  embeddedExplorerIFrame,
  operationId,
}: {
  operation: string;
  operationName?: string;
  variables?: JSONValue;
  headers?: Record<string, string>;
  embeddedExplorerIFrame?: HTMLIFrameElement;
  operationId: string;
}) {
  const response = await fetch(
    // Substitute your server's URL for this example URL.
    "https://apollo-fullstack-tutorial.herokuapp.com/",
    {
      method: "POST",
      headers: getHeadersWithContentType(headers),
      body: JSON.stringify({
        query: operation,
        variables,
        operationName,
      }),
    }
  );

  // After the operation completes, post a response message to the
  // iframe that includes the response data
  await response.json().then((response) => {
    embeddedExplorerIFrame?.contentWindow?.postMessage(
      {
        // Include the same operation ID in the response message's name
        // so the Explorer knows which operation it's associated with
        name: `${EXPLORER_QUERY_MUTATION_RESPONSE}:${operationId}`,
        response,
      },
      EMBEDDABLE_EXPLORER_URL
    );
  });
}
```

</MultiCodeBlock>

Instead of hardcoding your server's URL as shown, you can modify `executeOperation` to take a server URL parameter if you'll be embedding Explorers for multiple graphs.

#### 4. Embed the `iframe`

We're ready to add an embedded Explorer to our page! Here's an example `App.tsx` file that uses our `setupEmbedRelay` function to wire up an embedded Explorer `iframe`:

<MultiCodeBlock>

```tsx:title=App.tsx
import React, { useEffect } from 'react';
import { EMBEDDABLE_EXPLORER_URL, setUpEmbedRelay } from './setupEmbedRelay';

export const App = ()=> {

  useEffect(() => {
    setUpEmbedRelay();
  }, [])

  // Provide iframe options via URL query parameters
  const explorerURL = EMBEDDABLE_EXPLORER_URL +
    '?graphRef=Apollo-Fullstack-Demo-o3tsz8@current' +
    '&docsPanelState=closed';

  return (
    <div className="App">
      <h1 className="demo-app-title">Apollo's Embedded Explorer Demo App</h1>
      <iframe id="embedded-explorer" className="embedded-explorer-iframe" title="embedded-explorer" src={explorerURL} />
    </div>
  );
}
```

</MultiCodeBlock>

##### Providing a `graphRef`

Notice above that we append some query parameters to our `iframe`'s URL. The most important of these is `graphRef`. This tells the Explorer which [public variant's](#public-graphs) schema to download to populate the Documentation panel and enable symbol completion.

> **Always provide a `graphRef`!** If you don't, the embedded Explorer can't download your schema to enable features like symbol completion and documentation.

Other supported query parameters (like `docsPanelState` used above) are listed in [Options](#options).

#### 5. Run the example

You can view and run a complete example that uses code very similar to the above on Codesandbox:

<a href="https://codesandbox.io/s/github/apollographql/embeddable-explorer-demo-react/tree/main/?fontsize=14&hidenavigation=1&theme=dark">
  <img alt="Edit embedded-explorer-demo" src="https://codesandbox.io/static/img/play-codesandbox.svg" />
</a>

The example includes support for subscriptions, which are omitted from this Setup section for clarity. The subscription-specific logic should be more straightforward after familiarizing yourself with the logic for queries and mutations.

### Options

When you embed the Explorer, you set options for it by including query parameters in the `src` URL of the `iframe`, like so:

```jsx:title=EmbeddedExplorer.jsx
return (
  <iframe src={`https://explorer.embed.apollographql.com/?graphRef=${myGraphRef}&docsPanelState=closed`} />
);
```

The following options are supported:

<table class="field-table api-ref">
  <thead>
    <tr>
      <th>Name /<br/>Type</th>
      <th>Description</th>
    </tr>
  </thead>

<tbody>
<tr class="required">
<td>

##### `graphRef`

`string`

</td>
<td>

**Required.** The graph ref for the [public variant](#public-graphs) you want to use the embedded Explorer with. Has the format `graph-name@variant-name`.

The Explorer fetches this variant's schema from Apollo Studio to populate its Documentation panel and enable symbol completion.

If you omit this option, the Explorer _does_ still load, but it doesn't know which schema to fetch. This prevents the Explorer from providing critical features like documentation and symbol completion.

</td>
</tr>

<tr>
<td>

##### `docsPanelState`

`"open" | "closed"`

</td>
<td>

If `open`, the Explorer's Documentation panel (the left column) is initially expanded. If `closed`, the panel is initially collapsed.

The default value is `open`.

</td>
</tr>

<tr>
<td>

##### `showHeadersAndEnvVars`

`"true" | "false"`

</td>
<td>

If `true`, the embedded Explorer includes the panels for [setting request headers and environment variables](./explorer/#authentication). If `false`, those panels are not present.

The default value is `true`.

</td>
</tr>

<tr>
<td>

##### `theme`

`"dark" | "light"`

</td>
<td>

If `dark`, the Explorer's dark theme is used. If `light`, the light theme is used.

The default value is `dark`.

</td>
</tr>
</tbody>
</table>

### Message types

Your webpage and the embedded Explorer use the `postMessage` API to send messages to each other. Every message posted this way has an `event.data.name` with the following format:

```
MESSAGE_TYPE:OPERATION_ID
```

* `MESSAGE_TYPE` indicates the type of message being sent (e.g., `ExplorerRequest`).
* `OPERATION_ID` is a unique generated ID for a particular operation that the user initiates in the embedded Explorer.
    * You include this same operation ID in the names of messages you post from your page so the Explorer knows which operation the message pertains to.

These are all of the message types used by the embedded Explorer's `iframe` and your page:

<table class="field-table api-ref">
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>

<tbody>
<tr>
<td>

##### `ExplorerRequest`

</td>
<td>

Posted by the `iframe` to notify your page that the user wants to execute a query or mutation.

The following operation details are included in the associated `event.data` object:

* `operation` (string)
* `operationName` (string)
* `variables` (object)
* `headers` (object)

</td>
</tr>

<tr>
<td>

##### `ExplorerResponse`

</td>
<td>

Posted by your page to notify the `iframe` of a query or mutation result. The message should be the operation's JSON response object.

</td>
</tr>

<tr>
<td>

##### `ExplorerSubscriptionRequest`

</td>
<td>

Posted by the `iframe` to notify your page that the user wants to execute a subscription operation.

The same operation details are included in the `event.data` object that are included in [`ExplorerRequest` messages](#explorerrequest).

</td>
</tr>

<tr>
<td>

##### `ExplorerSubscriptionResponse`

</td>
<td>

Posted by your page to notify the `iframe` of a new subscription result. The message should be the subscription's new JSON response object.

</td>
</tr>

<tr>
<td>

##### `ExplorerSubscriptionTermination`

</td>
<td>

Posted by the `iframe` to notify your page that the user wants to terminate an active subscription operation.

</td>
</tr>
</tbody>
</table>
